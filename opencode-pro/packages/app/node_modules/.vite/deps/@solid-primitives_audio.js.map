{
  "version": 3,
  "sources": ["../../../../../node_modules/.bun/@solid-primitives+audio@1.4.2+95b571dd5236cc92/node_modules/@solid-primitives/audio/dist/index.js"],
  "sourcesContent": ["import { onMount, onCleanup, createEffect } from \"solid-js\";\nimport { isServer } from \"solid-js/web\";\nimport { access, noop } from \"@solid-primitives/utils\";\nimport { createStaticStore } from \"@solid-primitives/static-store\";\n// Set of control enums\nexport var AudioState;\n(function (AudioState) {\n    AudioState[\"LOADING\"] = \"loading\";\n    AudioState[\"PLAYING\"] = \"playing\";\n    AudioState[\"PAUSED\"] = \"paused\";\n    AudioState[\"COMPLETE\"] = \"complete\";\n    AudioState[\"STOPPED\"] = \"stopped\";\n    AudioState[\"READY\"] = \"ready\";\n    AudioState[\"ERROR\"] = \"error\";\n})(AudioState || (AudioState = {}));\n// Helper for producing the audio source\nconst unwrapSource = (src) => {\n    if (src instanceof HTMLAudioElement) {\n        return src;\n    }\n    const player = new Audio();\n    setAudioSrc(player, src);\n    return player;\n};\nfunction setAudioSrc(el, src) {\n    el[typeof src === \"string\" ? \"src\" : \"srcObject\"] = src;\n}\n/**\n * Generates a basic audio instance with limited functionality.\n *\n * @param src Audio file path or MediaSource to be played\n * @param handlers An array of handlers to bind against the player\n * @return A basic audio player instance\n */\nexport const makeAudio = (src, handlers = {}) => {\n    if (isServer) {\n        return {};\n    }\n    const player = unwrapSource(src);\n    onMount(() => {\n        for (const [name, handler] of Object.entries(handlers)) {\n            player.addEventListener(name, handler);\n        }\n    });\n    onCleanup(() => {\n        player.pause();\n        for (const [name, handler] of Object.entries(handlers)) {\n            player.removeEventListener(name, handler);\n        }\n    });\n    return player;\n};\n/**\n * Generates a basic audio player with simple control mechanisms.\n *\n * @param src Audio file path or MediaSource to be played\n * @return options - @type Object\n * @return options.start - Start playing\n * @return options.pause - Pause playing\n * @return options.seek - Seeks to a location in the playhead\n * @return options.setVolume - Sets the volume of the player\n * @return options.player - Raw player instance\n * @return Returns a location signal and one-off async query callback\n *\n * @example\n * ```ts\n * const { start, seek } = makeAudioPlayer('./example1.mp3');\n * ```\n */\nexport const makeAudioPlayer = (src, handlers = {}) => {\n    if (isServer) {\n        return {\n            pause: noop,\n            play: async () => noop(),\n            player: {},\n            seek: noop,\n            setVolume: noop,\n        };\n    }\n    const player = makeAudio(src, handlers);\n    return {\n        player,\n        play: () => player.play(),\n        pause: () => player.pause(),\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        seek: player.fastSeek\n            ? (time) => player.fastSeek(time)\n            : (time) => (player.currentTime = time),\n        setVolume: (volume) => (player.volume = volume),\n    };\n};\n/**\n * A reactive audio primitive with basic control actions.\n *\n * @param src Audio source path or MediaSource to be played or an accessor\n * @param playing A signal for controlling the player\n * @param volume A signal for controlling the volume\n * @return [store] - @type Store\n * @return [store.state] - Current state of the player\n * @return [store.currentTime] - Current time of the playhead\n * @return [store.duration] - Duration of the loaded file\n * @return [store.volume] - Current volume of the audio player\n * @return [store.player] - Raw player instance\n * @return [controls] - Controls for the audio player @type Object\n * @return [controls.seek] - Seeks to a specified location\n * @return [controls.play] - Start playing\n * @return [controls.pause] - Pause playing\n * @return [controls.setVolume] - Sets the volume of the player, from 0 to 1\n *\n *\n * @example\n * ```ts\n * const [playing, setPlaying] = createSignal(false);\n * const [volume, setVolume] = createSignal(1);\n * const [audio, controls] = createAudio('./example1.mp3', playing, volume);\n * console.log(audio.duration);\n * ```\n */\nexport const createAudio = (src, playing, volume) => {\n    if (isServer) {\n        return [\n            {\n                state: AudioState.LOADING,\n                currentTime: 0,\n                duration: 0,\n                volume: 0,\n                player: {},\n            },\n            {\n                seek: noop,\n                setVolume: noop,\n                play: async () => noop(),\n                pause: noop,\n            },\n        ];\n    }\n    const player = unwrapSource(access(src));\n    const [store, setStore] = createStaticStore({\n        state: AudioState.LOADING,\n        player,\n        currentTime: 0,\n        duration: 0,\n        volume: 0,\n    });\n    const { play, pause, setVolume: _setVolume, seek, } = makeAudioPlayer(store.player, {\n        loadeddata: () => {\n            setStore({\n                state: AudioState.READY,\n                duration: player.duration,\n            });\n            if (playing && playing()) {\n                play().catch((e) => {\n                    if (e.name === \"NotAllowedError\") {\n                        setStore(\"state\", AudioState.ERROR);\n                    }\n                });\n            }\n        },\n        timeupdate: () => setStore(\"currentTime\", player.currentTime),\n        loadstart: () => setStore(\"state\", AudioState.LOADING),\n        playing: () => setStore(\"state\", AudioState.PLAYING),\n        pause: () => setStore(\"state\", AudioState.PAUSED),\n        error: () => setStore(\"state\", AudioState.ERROR),\n        ended: () => setStore(\"state\", AudioState.COMPLETE),\n    });\n    const setVolume = (volume) => {\n        setStore(\"volume\", volume);\n        _setVolume(volume);\n    };\n    // Bind reactive properties as needed\n    if (src instanceof Function) {\n        createEffect(() => {\n            const newSrc = src();\n            if (newSrc instanceof HTMLAudioElement) {\n                setStore(\"player\", newSrc);\n            }\n            else {\n                setAudioSrc(store.player, newSrc);\n            }\n            seek(0);\n        });\n    }\n    if (playing) {\n        createEffect(() => (playing() ? play() : pause()));\n    }\n    if (volume) {\n        createEffect(() => setVolume(volume()));\n        setVolume(volume());\n    }\n    return [store, { seek, play, pause, setVolume }];\n};\n"],
  "mappings": "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",
  "names": ["AudioState", "volume"]
}
